<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TransitFLOW - Authentication</title>
    <link rel="icon"
        href="https://spotless-orange-flea.myfilebase.com/ipfs/QmfQnE6xe5hSHT8gw3NDVWVXdXRmwqJa9PvScNj3fbMFgy"
        type="image/png">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/boxicons.min.css">
    <script defer src="https://app.letstrack.qzz.io/script.js"
        data-website-id="e854b045-2569-4172-a4c0-b8fcb47c5c23"></script>

    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
        _paq.push(["setCookieDomain", "*.account.transitflow.qzz.io"]);
        _paq.push(["setDomains", ["*.account.transitflow.qzz.io"]]);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function () {
            var u = "//letsreply.dpdns.org/";
            _paq.push(['setTrackerUrl', u + 'matomo.php']);
            _paq.push(['setSiteId', '1']);
            var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
            g.async = true; g.src = u + 'matomo.js'; s.parentNode.insertBefore(g, s);
        })();
    </script>
    <noscript>
        <p><img referrerpolicy="no-referrer-when-downgrade" src="//letsreply.dpdns.org/matomo.php?idsite=1&amp;rec=1"
                style="border:0;" alt="" /></p>
    </noscript>
    <!-- End Matomo Code -->

</head>

<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle" id="theme-toggle">
        <i class="bx bx-moon" id="theme-icon"></i>
    </div>
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-logo-container">
            <div class="loading-logo">
                <img src="https://spotless-orange-flea.myfilebase.com/ipfs/QmfQnE6xe5hSHT8gw3NDVWVXdXRmwqJa9PvScNj3fbMFgy"
                    alt="TransitFLOW Logo">
            </div>
        </div>
        <div class="loading-progress-container">
            <div class="loading-progress-bar" id="loadingProgressBar"></div>
        </div>
        <div class="loading-text" id="loadingText">Loading TransitFLOW...</div>
        <div class="loading-percentage" id="loadingPercentage">0%</div>
    </div>

    <div class="auth-page-container">
        <div class="branding-panel">
            <img src="https://spotless-orange-flea.myfilebase.com/ipfs/QmZ7KzNrnnFMb7omqMpZvJXxdRddHT7XuJgSd9PUUCJ3yj"
                alt="TransitFLOW Logo" class="branding-logo">
            <div class="branding-content">
                <h1 class="branding-title">TransitFLOW</h1>
                <p class="branding-subtitle">Your city, your route, your price.</p>
            </div>
            <div class="branding-quote">
                <p>"The most reliable way to navigate the city's transit."</p>
                <span>- Satisfied Commuter</span>
            </div>
        </div>
        <div class="form-panel">
            <div class="auth-container">
                <div class="auth-card fade-in">

                    <!-- Login Form -->
                    <div id="login-form" class="auth-step">
                        <!-- Step 1: Credentials -->
                        <div id="login-step-1">
                            <div class="auth-header">
                                <h1 class="auth-title">Welcome back</h1>
                                <p class="auth-subtitle">Sign in to your account</p>
                            </div>
                            <div class="error-container"></div>
                            <form class="auth-form" id="loginForm">
                                <div id="login-alert"></div>
                                <div class="form-group">
                                    <label class="form-label" for="login-identifier">Email or Username</label>
                                    <input type="text" id="login-identifier" name="identifier" class="form-input"
                                        autocomplete="username" required>
                                    <span class="form-error" id="login-identifier-error"></span>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="login-password">Password</label>
                                    <div class="input-group">
                                        <input type="password" id="login-password" name="password" class="form-input"
                                            autocomplete="current-password" required>
                                        <i class="bx bx-hide input-icon" id="login-password-toggle"></i>
                                    </div>
                                    <span class="form-error" id="login-password-error"></span>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="remember-me" name="rememberMe" class="checkbox">
                                    <label for="remember-me" class="checkbox-label">Remember me for 30 days</label>
                                </div>
                                <button type="submit" class="btn btn-primary">Sign In</button>
                            </form>
                            <div class="auth-footer">
                                <p>Or <a href="#" class="auth-link" id="show-social-login">continue with a social
                                        account</a></p>
                                <p><a href="#" class="auth-link" id="show-forgot-password">Forgot your password?</a>
                                <p style="margin-top: 1rem;">Don't have an account? <a href="#" class="auth-link"
                                        id="show-register">Sign up</a></p>
                            </div>
                        </div>
                        <!-- Step 2: Social Login -->
                        <div id="login-step-2" class="hidden">
                            <div class="auth-header">
                                <h1 class="auth-title">Welcome back</h1>
                                <p class="auth-subtitle">Sign in with a social account</p>
                            </div>
                            <div class="social-auth-section">
                                <div class="social-buttons">
                                    <button type="button" class="btn btn-social btn-google" id="google-login">
                                        <i class="bx bxl-google"></i>
                                        Continue with Google
                                    </button>
                                    <button type="button" class="btn btn-social btn-facebook" id="facebook-login">
                                        <i class="bx bxl-facebook"></i>
                                        Continue with Facebook
                                    </button>
                                    <button type="button" class="btn btn-social btn-github" id="github-login">
                                        <i class="bx bxl-github"></i>
                                        Continue with GitHub
                                    </button>
                                </div>
                            </div>
                            <div class="auth-footer">
                                <p><a href="#" class="auth-link" id="show-credential-login">← Back to email login</a>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Register Form: Progressive Steps -->
                    <div id="register-form" class="auth-step hidden">
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" id="register-progress-fill"></div>
                        </div>
                        <form class="auth-form" id="registerForm">
                            <div id="register-alert"></div>

                            <!-- Step 1: Name -->
                            <div id="register-step-1" class="register-step">
                                <div class="auth-header">
                                    <h1 class="auth-title">Create your account (1/5)</h1>
                                    <p class="auth-subtitle">Let's start with your name.</p>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="first-name">First Name *</label>
                                    <input type="text" id="first-name" name="firstName" class="form-input" required>
                                    <span class="form-error" id="first-name-error"></span>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="last-name">Last Name (optional)</label>
                                    <input type="text" id="last-name" name="lastName" class="form-input">
                                    <span class="form-error" id="last-name-error"></span>
                                </div>
                                <button type="button" class="btn btn-primary" id="register-next-1">Next</button>
                            </div>

                            <!-- Step 2: Identity -->
                            <div id="register-step-2" class="register-step hidden">
                                <div class="auth-header">
                                    <h1 class="auth-title">About you (2/5)</h1>
                                    <p class="auth-subtitle">Help us personalize your experience.</p>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="date-of-birth">Date of Birth *</label>
                                    <input type="date" id="date-of-birth" name="dateOfBirth" class="form-input"
                                        required>
                                    <span class="form-error" id="date-of-birth-error"></span>
                                </div>
                                <div class="form-group" style="position: relative;">
                                    <label class="form-label" for="username">Username *</label>
                                    <div class="input-group">
                                        <input type="text" id="username" name="username" class="form-input"
                                            autocomplete="username" required>
                                        <i class=" input-icon" id="username-status"></i>
                                    </div>
                                    <span class="form-error" id="username-error"></span>
                                    <div id="username-suggestions" class="username-suggestions hidden"></div>
                                </div>
                                <div class="button-group">
                                    <button type="button" class="btn btn-secondary" id="register-back-1">Back</button>
                                    <button type="button" class="btn btn-primary" id="register-next-2">Next</button>
                                </div>
                            </div>

                            <!-- Step 3: Contact -->
                            <div id="register-step-3" class="register-step hidden">
                                <div class="auth-header">
                                    <h1 class="auth-title" id="register-greeting">Contact Information (3/5)</h1>
                                    <p class="auth-subtitle">How can we reach you?</p>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="email">Email *</label>
                                    <input type="email" id="email" name="email" class="form-input" autocomplete="email"
                                        required>
                                    <span class="form-error" id="email-error"></span>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="phone">Phone (Optional)</label>
                                    <input type="tel" id="phone" name="phone" class="form-input" autocomplete="tel"
                                        placeholder="+92 3XX XXXXXXX">
                                    <span class="form-error" id="phone-error"></span>
                                </div>
                                <div class="button-group">
                                    <button type="button" class="btn btn-secondary" id="register-back-2">Back</button>
                                    <button type="button" class="btn btn-primary" id="register-next-3">Next</button>
                                </div>
                            </div>

                            <!-- Step 4: Account Details -->
                            <div id="register-step-4" class="register-step hidden">
                                <div class="auth-header">
                                    <h1 class="auth-title">Secure your account (4/5)</h1>
                                    <p class="auth-subtitle">Choose a strong password.</p>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="password">Password *</label>
                                    <div class="input-group">
                                        <input type="password" id="password" name="password" class="form-input"
                                            autocomplete="current-password" required>
                                        <i class="bx bx-hide input-icon" id="password-toggle"></i>
                                    </div>
                                    <div class="password-strength">
                                        <div class="strength-bar">
                                            <div class="strength-fill" id="strength-fill"></div>
                                        </div>
                                        <div class="strength-text" id="strength-text">Enter a password</div>
                                    </div>
                                    <span class="form-error" id="password-error"></span>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="user-type">User Type *</label>
                                    <select id="user-type" name="userType" class="form-input" required>
                                        <option value="">Select user type</option>
                                        <option value="student">Student</option>
                                        <option value="commuter">Commuter</option>
                                        <option value="business">Business</option>
                                        <option value="individual">Individual</option>
                                        <option value="other">Other</option>
                                    </select>
                                    <span class="form-error" id="user-type-error"></span>
                                </div>
                                <div class="button-group">
                                    <button type="button" class="btn btn-secondary" id="register-back-3">Back</button>
                                    <button type="button" class="btn btn-primary" id="register-next-4">Review
                                        Details</button>
                                </div>
                            </div>

                            <!-- Step 5: Review -->
                            <div id="register-step-5-review" class="register-step hidden">
                                <div class="auth-header">
                                    <h1 class="auth-title">Review Your Details (5/5)</h1>
                                    <p class="auth-subtitle">Please confirm your information is correct.</p>
                                </div>
                                <div class="review-details" id="review-details-container">
                                    <!-- JS will populate this -->
                                </div>
                                <p class="terms-agreement">By creating account, you agree to our <a
                                        href="https://policy.transitflow.qzz.io/terms" target="_blank"
                                        class="auth-link">Terms of Service</a> and <a
                                        href="https://policy.transitflow.qzz.io/privacy" target="_blank"
                                        class="auth-link">Privacy Policy</a>.</p>
                                <div class="button-group">
                                    <button type="button" class="btn btn-secondary" id="register-back-4">Back</button>
                                    <button type="submit" class="btn btn-primary">Confirm & Create Account</button>
                                </div>
                            </div>
                        </form>

                        <div class="auth-footer">
                            <p>Already have an account? <a href="#" class="auth-link" id="back-to-login">Sign in</a></p>
                        </div>
                    </div>

                    <!-- 2FA Verification Form -->
                    <div id="two-factor-form" class="auth-step hidden">
                        <div class="auth-header">
                            <div class="auth-logo"><i class="bx bx-lock-alt"></i></div>
                            <h1 class="auth-title">Two-Factor Authentication</h1>
                            <p class="auth-subtitle">Enter the 6-digit code from your authenticator app</p>
                        </div>

                        <!-- Error Container for 2FA -->
                        <div class="error-container"></div>

                        <form class="auth-form" id="twoFactorForm">
                            <div id="two-factor-alert"></div>

                            <div class="two-factor-grid">
                                <input type="text" class="two-factor-input" maxlength="1" data-index="0">
                                <input type="text" class="two-factor-input" maxlength="1" data-index="1">
                                <input type="text" class="two-factor-input" maxlength="1" data-index="2">
                                <input type="text" class="two-factor-input" maxlength="1" data-index="3">
                                <input type="text" class="two-factor-input" maxlength="1" data-index="4">
                                <input type="text" class="two-factor-input" maxlength="1" data-index="5">
                            </div>

                            <button type="submit" class="btn btn-primary">Verify Code</button>
                            <button type="button" class="btn btn-secondary" id="show-backup-code"
                                style="margin-top: 0.5rem;">Use Backup Code</button>
                        </form>

                        <div class="auth-footer">
                            <p><a href="#" class="auth-link" id="back-to-login-from-2fa">← Back to login</a></p>
                        </div>
                    </div>

                    <!-- Backup Code Form -->
                    <div id="backup-code-form" class="auth-step hidden">
                        <div class="auth-header">
                            <div class="auth-logo"><i class="bx bx-key"></i></div>
                            <h1 class="auth-title">Backup Code</h1>
                            <p class="auth-subtitle">Enter one of your backup codes</p>
                        </div>

                        <!-- Error Container for Backup Code -->
                        <div class="error-container"></div>

                        <form class="auth-form" id="backupCodeForm">
                            <div id="backup-code-alert"></div>

                            <div class="form-group">
                                <label class="form-label" for="backup-code">Backup Code</label>
                                <input type="text" id="backup-code" name="backupCode" class="form-input"
                                    placeholder="XXXXXXXX" maxlength="8" required>
                                <span class="form-error" id="backup-code-error"></span>
                            </div>

                            <button type="submit" class="btn btn-primary">Verify Code</button>
                        </form>

                        <div class="auth-footer">
                            <p><a href="#" class="auth-link" id="back-to-2fa">← Back to 2FA</a></p>
                        </div>
                    </div>
                    <!-- Email Verification Form -->
                    <div id="email-verification-form" class="auth-step hidden">
                        <div class="auth-header">
                            <div class="auth-logo"><i class="bx bx-envelope"></i></div>
                            <h1 class="auth-title">Verify Email</h1>
                            <p class="auth-subtitle">Enter the 6-digit code sent to your email</p>
                        </div>

                        <!-- Error Container for Email Verification -->
                        <div class="error-container"></div>

                        <form class="auth-form" id="emailVerificationForm">
                            <div id="email-verification-alert"></div>

                            <div class="form-group">
                                <label class="form-label" for="verification-code">Verification Code</label>
                                <input type="text" id="verification-code" name="otp" class="form-input" maxlength="6"
                                    pattern="[0-9]{6}" required>
                                <span class="form-error" id="verification-code-error"></span>
                            </div>

                            <button type="submit" class="btn btn-primary">Verify Email</button>
                            <button type="button" class="btn btn-secondary" id="resend-verification"
                                style="margin-top: 0.5rem;">Resend Code</button>
                        </form>

                        <div class="auth-footer">
                            <p><a href="#" class="auth-link" id="back-to-login-from-verification">← Back to login</a>
                            </p>
                        </div>
                    </div>

                    <!-- Forgot Password Form -->
                    <div id="forgot-password-form" class="auth-step hidden">
                        <div class="auth-header">
                            <div class="auth-logo"><i class="bx bx-refresh"></i></div>
                            <h1 class="auth-title">Reset Password</h1>
                            <p class="auth-subtitle">Enter your email to receive reset instructions</p>
                        </div>

                        <!-- Error Container for Forgot Password -->
                        <div class="error-container"></div>

                        <form class="auth-form" id="forgotPasswordForm">
                            <div id="forgot-password-alert"></div>

                            <div class="form-group">
                                <label class="form-label" for="forgot-email">Email</label>
                                <input type="email" id="forgot-email" name="email" class="form-input"
                                    autocomplete="email" required>
                                <span class="form-error" id="forgot-email-error"></span>
                            </div>

                            <button type="submit" class="btn btn-primary">Send Reset Link</button>
                        </form>

                        <div class="auth-footer">
                            <p><a href="#" class="auth-link" id="back-to-login-from-forgot">← Back to login</a></p>
                        </div>
                    </div>

                </div>
                <div id="toastContainer" class="toast-container"></div>
            </div>
        </div>
    </div>

    <!-- Core Dependencies -->
    <script src="/js/auth/services/ApiClient.js"></script>
    <script src="/js/auth/services/SocialAuthManager.js"></script>
    <script src="/js/auth/ui/UIManager.js"></script>
    <script src="/js/auth/ui/ThemeManager.js"></script>
    <script src="/js/auth/validation/FormValidator.js"></script>
    <script src="/js/auth/network/NetworkManager.js"></script>
    <script src="/js/auth/forms/FormHandler.js"></script>
    <script src="/js/auth/events/EventManager.js"></script>
    <script src="/js/auth/routing/RouterManager.js"></script>
    <script src="/js/auth/core/AuthManager.js"></script>
    <script src="/js/auth/core/InitManager.js"></script>
    <script src="https://transitflow2.statuspage.io/embed/script.js"></script>
    <script>
        (function (d, t) {
            var BASE_URL = "https://chatwoot-production-5a33.up.railway.app";
            var g = d.createElement(t), s = d.getElementsByTagName(t)[0];
            g.src = BASE_URL + "/packs/js/sdk.js";
            g.async = true;
            s.parentNode.insertBefore(g, s);
            g.onload = function () {
                window.chatwootSDK.run({
                    websiteToken: 'Wf3jiwU8aae588BoBzmzN6Hp',
                    baseUrl: BASE_URL
                })
            }
        })(document, "script");
    </script>

</body>

</html>